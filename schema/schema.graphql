scalar NameText
scalar SmallText
scalar MediumText
scalar LargeText
scalar ExtraLargeText
scalar InterpolatedMessage

scalar RegularExpression
scalar Error

scalar URLText
scalar URL
scalar Resource

scalar SettingsBundleName

scalar TimeoutDuration

scalar Document
scalar File
scalar FileNameOnly
scalar FilePathAndName
scalar DirectoryPath

scalar Date
scalar PastDate
scalar FutureDate
scalar DateTime
scalar PastDateTime
scalar FutureDateTime
scalar Timestamp

type HTTPClientSettings {
    userAgent: String!
    timeout: TimeoutDuration!
} 

enum DuplicateRetentionType {
    RetainAll
    RetainAllButWarnOnDuplicate
    RetainFirstSkipRemaining
    RetainLastReplacingPrevious
}

type LinkHarvesterSettings {
    ignoreURLsRegExprs : [RegularExpression]
    removeParamsFromURLsRegEx : [RegularExpression]
    followHTMLRedirects : Boolean!
    duplicateLinkRetentionType: DuplicateRetentionType!
    skipURLHumanMessageFormat: InterpolatedMessage!
    inspectLinkDestinations: Boolean!
    downloadLinkAttachments: Boolean!
}

type ContentTitleSettings {
    removePipedSuffix : Boolean!
    warnAboutPipedSuffix : Boolean!
    removeHyphenatedSuffix : Boolean!
    warnAboutHyphenatedSuffix : Boolean!
}

type ContentSummarySettings {
    useFirstSentenceOfBody : Boolean!
    useFirstSentenceOfBodyIfEmpty : Boolean!
}

type ContentBodySettings {
    allowFrontmatter : Boolean!
    frontMatterPropertyNamePrefix : String!
}

type ContentSettings {
    title: ContentTitleSettings!
    summary: ContentSummarySettings!
    body: ContentBodySettings!
}

type SettingsBundle {
    name : SettingsBundleName!
    harvester : LinkHarvesterSettings!
    content: ContentSettings!
    httpClient: HTTPClientSettings!
}

# scalar LinkDestinationContentMIMEType
# scalar LinkDestinationContentMediaType
# scalar LinkDestinationHTMLRedirectURLText
# scalar LinkDestinationHTMLParseError
# scalar LinkDestinationMediaTypeError

# scalar LinkAttachmentFileType
# scalar LinkAttachmentDownloadError
# scalar LinkAttachmentFileTypeError

# type LinkAttachment {
# 	url: URL
#     downloaded: Boolean!
# 	destPath: FilePathAndName!
# 	downloadError: LinkAttachmentDownloadError
# 	fileTypeError: LinkAttachmentFileTypeError
# 	fileType: LinkAttachmentFileType!
# }

# enum LinkDestinationValidity {
#     NotValidated
#     Valid
#     Invalid
# }

# type LinkDestination {
#     url: URL
#     validity: LinkDestinationValidity!
#     contentType: LinkDestinationContentMIMEType!
#     mediaType: LinkDestinationContentMediaType!
#     mediaTypeParams: [Property!]
#     mediaTypeError: LinkDestinationMediaTypeError
#     htmlParseError: LinkDestinationHTMLParseError
#     isHTMLRedirect: Boolean
#     metaRefreshTagContentURLText: LinkDestinationHTMLRedirectURLText
#     metaPropertyTags: [Property!]
# }

interface Link {
    id: ID!
    urlText: URLText!
	finalURL: URL
    isValid: Boolean!
    # destination: LinkDestination
    # attachment: LinkAttachment
}

interface ContentSource {
    name: NameText!
}

interface Content {
    id: ID!
}

interface ContentCollection {
    id: ID!
    source: ContentSource
    content: [Content]
}

scalar ContentTitleText
scalar ContentSummaryText
scalar ContentBodyText

type HarvestedLink implements Content & Link {
    id: ID!
    urlText: URLText!
	finalURL: URL
    isValid: Boolean!
    # destination: LinkDestination
    # attachment: LinkAttachment
    title: ContentTitleText!
    summary: ContentSummaryText!
    body: ContentBodyText!
    properties: Properties
	isIgnored: Boolean!
	ignoreReason: InterpolatedMessage
}

type APISource implements ContentSource {
    name: NameText!
    apiEndpoint: URLText!
}

type HarvestedLinks implements ContentCollection {
    id: ID!
    source: ContentSource!
    content: [HarvestedLink!]
    activities: Activities!
    properties: Properties
}

type Query {
    defaultSettingsBundle : SettingsBundle
    settingsBundle(name: SettingsBundleName!) : SettingsBundle
    source(source : URLText!) : ContentSource
    harvestedLinks(source : URLText!, settingsBundle: SettingsBundleName! = "DEFAULT") : HarvestedLinks
}
